services:
  pocdocv2:
    build: .
    image: pocdocv2
    ports:
      - "3000:3000"
    environment:
      # =======================================================================
      # MODE CONFIGURATION
      # =======================================================================
      # "poc" = POC mode (registers with backend, sends heartbeat)
      # "demo" = Demo mode (no backend communication)
      - POC_OR_DEMO=${POC_OR_DEMO:-demo}
      
      # =======================================================================
      # CUSTOMER CONFIGURATION
      # =======================================================================
      - PROSPECT=${PROSPECT:-demo}
      - PARTNER=${PARTNER:-}
      - SAAS_NAME=${SAAS_NAME:-Certificate Manager SaaS}
      - VAAS_API_KEY=x
      #- POC_START_DATE=${POC_START_DATE:-}
      #- POC_END_DATE=${POC_END_DATE:-}
      - PASSWORD="newPassword123!"
      # =======================================================================
      # SA CONFIGURATION (required for POC mode)
      # =======================================================================
      - SA_NAME=${SA_NAME:-}
      - SA_EMAIL=${SA_EMAIL:-}
      
      # =======================================================================
      # BACKEND API CONFIGURATION
      # =======================================================================
      # URL of the POC Portal backend API
      - POC_INSIGHTS_URL=${POC_INSIGHTS_URL:-https://pocinsights.mimlab.io:9443}
      # API key for authentication with backend
      - API_SHARED_SECRET=${API_SHARED_SECRET:-}
      # Heartbeat interval in minutes (default: 1440 = 24 hours)
      - HEARTBEAT_INTERVAL_MINUTES=${HEARTBEAT_INTERVAL_MINUTES:-1440}
      
      # =======================================================================
      # USE CASE CONFIGURATION (Required)
      # =======================================================================
      # S3 bucket or repo URL for downloading use cases (REQUIRED)
      - USE_CASE_REPO_URL=${USE_CASE_REPO_URL:-}
      # Local path for use cases (inside container)
      - USE_CASE_LOCAL_PATH=/app/use-cases
      # Comma-separated list of active use case IDs
      - ACTIVE_USE_CASES=${ACTIVE_USE_CASES:-}
      
      # =======================================================================
      # AUTHENTICATION CONFIGURATION
      # =======================================================================
      - AUTH_ADMIN_USERNAME=${AUTH_ADMIN_USERNAME:-admin}
      - AUTH_ADMIN_PASSWORD=${AUTH_ADMIN_PASSWORD:-admin}
      - AUTH_PROSPECT_PASSWORD=${AUTH_PROSPECT_PASSWORD:-password}
      - SESSION_SECRET=${SESSION_SECRET:-change-me-in-production}
      
      # =======================================================================
      # TLSPC CONFIGURATION
      # =======================================================================
      # API key for TLSPC - automatically discovers the correct regional endpoint
      # (US, EU, AU, UK, SG, CA) and tenant URL from this key at startup
      - TLSPC_API_KEY=${TLSPC_API_KEY:-}

      # =======================================================================
      # APPLICATION CONFIGURATION
      # =======================================================================
      - NODE_ENV=${NODE_ENV:-production}
      - PORT=3000
      - DEFAULT_PASSWORD=${DEFAULT_PASSWORD:-ChangeMe123!}
      
    restart: unless-stopped


# =============================================================================
# EXAMPLE CONFIGURATIONS
# =============================================================================
#
# Demo Mode (default):
# --------------------
#   POC_OR_DEMO=demo
#   PROSPECT=Demo Customer
#
# POC Mode (full integration):
# ----------------------------
#   POC_OR_DEMO=poc
#   PROSPECT=ACME Bank
#   PARTNER=BigPartner GmbH
#   SAAS_NAME=Certificate Manager SaaS
#   POC_START_DATE=2025-12-04
#   POC_END_DATE=2026-01-03
#   SA_NAME=Jens Sabitzer
#   SA_EMAIL=jens.sabitzer@cyberark.com
#   POC_INSIGHTS_URL=http://172.17.32.15:8000
#   API_SHARED_SECRET=supersecret-api-key
#   USE_CASE_REPO_URL=https://poc-documentation-usecases.s3.us-west-2.amazonaws.com
#
# =============================================================================